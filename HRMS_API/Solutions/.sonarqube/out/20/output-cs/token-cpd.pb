»
ÄF:\Work\Office\Projects\Nspira\Portal\HRMS_API\5-CrossCutting\Phoenix.CrossCutting.Utils\Database\ApplicationConnectionString.cs
	namespace 	
Phonix
 
. 
CrossCutting 
. 
Utils #
.# $
Database$ ,
{ 
public 

class '
ApplicationConnectionString ,
{ 
public 
string 
ConnectionString &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
} 
} ü
ÄF:\Work\Office\Projects\Nspira\Portal\HRMS_API\5-CrossCutting\Phoenix.CrossCutting.Utils\Extensions\ClaimsPrincipalExtensions.cs
	namespace 	
Phonix
 
. 
CrossCutting 
. 
Utils #
{ 
public 

static 
class %
ClaimsPrincipalExtensions 1
{ 
public 
static 
long "
GetAuthenticatedUserId 1
(1 2
this2 6
ClaimsPrincipal7 F
claimsPrincipalG V
)V W
{ 	
return		 
long		 
.		 
TryParse		  
(		  !
claimsPrincipal		! 0
.		0 1)
GetClaimValueOfNameIdentifier		1 N
(		N O
)		O P
,		P Q
out		R U
var		V Y
userId		Z `
)		` a
?		b c
userId		d j
:		k l
$num		m n
;		n o
}

 	
public 
static 
Claim 
GetClaim $
($ %
this% )
ClaimsPrincipal* 9
claimsPrincipal: I
,I J
stringK Q
	claimTypeR [
)[ \
{ 	
return 
claimsPrincipal "
?" #
.# $
	FindFirst$ -
(- .
	claimType. 7
)7 8
;8 9
} 	
public 
static 
string )
GetClaimValueOfNameIdentifier :
(: ;
this; ?
ClaimsPrincipal@ O
claimsPrincipalP _
)_ `
{ 	
return 
claimsPrincipal "
?" #
.# $
GetClaim$ ,
(, -

ClaimTypes- 7
.7 8
NameIdentifier8 F
)F G
?G H
.H I
ValueI N
;N O
} 	
} 
} Í3
yF:\Work\Office\Projects\Nspira\Portal\HRMS_API\5-CrossCutting\Phoenix.CrossCutting.Utils\Extensions\DateTimeExtensions.cs
	namespace 	
Phonix
 
. 
CrossCutting 
. 
Utils #
{ 
public 

static 
class 
DateTimeExtensions *
{ 
public 
static 
DateTime 
NextDateTime +
(+ ,
this, 0
DateTime1 9
dateTime: B
,B C
	DayOfWeekD M
[M N
]N O
daysP T
,T U
TimeSpanV ^
[^ _
]_ `
timesa f
)f g
{		 	
times

 
=

 
times

 
.

 
OrderBy

 !
(

! "
x

" #
=>

$ &
x

' (
.

( )
Hours

) .
)

. /
.

/ 0
ToArray

0 7
(

7 8
)

8 9
;

9 :
var 
	nextTimes 
= 
times !
.! "
Where" '
(' (
x( )
=>* ,
x- .
.. /
Hours/ 4
>5 6
dateTime7 ?
.? @
	TimeOfDay@ I
.I J
HoursJ O
)O P
.P Q
ToArrayQ X
(X Y
)Y Z
;Z [
return 
( 
	nextTimes 
. 
Length $
>% &
$num' (
)( )
?* +
(, -
dateTime- 5
.5 6
Date6 :
+; <
	nextTimes= F
[F G
$numG H
]H I
)I J
:K L
(M N
dateTimeN V
.V W
NextDateTimeW c
(c d
daysd h
)h i
.i j
Datej n
+o p
timesq v
[v w
$numw x
]x y
)y z
;z {
} 	
public 
static 
DateTime 
NextDateTime +
(+ ,
this, 0
DateTime1 9
dateTime: B
,B C
paramsD J
	DayOfWeekK T
[T U
]U V
daysW [
)[ \
{ 	
return 

Enumerable 
. 
Range #
(# $
$num$ %
,% &
$num' (
)( )
.) *
Cast* .
<. /
double/ 5
>5 6
(6 7
)7 8
.8 9
Select9 ?
(? @
dateTime@ H
.H I
AddDaysI P
)P Q
.Q R
FirstR W
(W X
yX Y
=>Z \
days] a
.a b
Containsb j
(j k
yk l
.l m
	DayOfWeekm v
)v w
)w x
;x y
} 	
public 
static 
DateTime 
SetTime &
(& '
this' +
DateTime, 4
dateTime5 =
,= >
string? E
timeF J
)J K
{ 	
if 
( 
string 
. 
IsNullOrWhiteSpace )
() *
time* .
). /
)/ 0
{ 
return 
dateTime 
;  
} 
var 
parts 
= 
time 
. 
Split "
(" #
$char# &
)& '
;' (
if 
( 
parts 
. 
Length 
< 
$num  
)  !
{ 
return 
dateTime 
;  
}   
if"" 
("" 
!"" 
int"" 
."" 
TryParse"" 
("" 
parts"" #
[""# $
$num""$ %
]""% &
,""& '
out""( +
var"", /
hours""0 5
)""5 6
)""6 7
{## 
return$$ 
dateTime$$ 
;$$  
}%% 
if'' 
('' 
!'' 
int'' 
.'' 
TryParse'' 
('' 
parts'' #
[''# $
$num''$ %
]''% &
,''& '
out''( +
var'', /
minutes''0 7
)''7 8
)''8 9
{(( 
return)) 
dateTime)) 
;))  
}** 
if,, 
(,, 
!,, 
int,, 
.,, 
TryParse,, 
(,, 
parts,, #
[,,# $
$num,,$ %
],,% &
,,,& '
out,,( +
var,,, /
seconds,,0 7
),,7 8
),,8 9
{-- 
return.. 
dateTime.. 
;..  
}// 
return11 
SetTime11 
(11 
dateTime11 #
,11# $
hours11% *
,11* +
minutes11, 3
,113 4
seconds115 <
)11< =
;11= >
}22 	
public44 
static44 
DateTime44 
SetTime44 &
(44& '
this44' +
DateTime44, 4
dateTime445 =
,44= >
int44? B
hours44C H
,44H I
int44J M
minutes44N U
,44U V
int44W Z
seconds44[ b
)44b c
{55 	
if66 
(66 
hours66 
<66 
$num66 
||66 
hours66 "
>66# $
$num66% '
)66' (
{77 
return88 
dateTime88 
;88  
}99 
if;; 
(;; 
minutes;; 
<;; 
$num;; 
||;; 
minutes;; &
>;;' (
$num;;) +
);;+ ,
{<< 
return== 
dateTime== 
;==  
}>> 
if@@ 
(@@ 
seconds@@ 
<@@ 
$num@@ 
||@@ 
seconds@@ &
>@@' (
$num@@) +
)@@+ ,
{AA 
returnBB 
dateTimeBB 
;BB  
}CC 
returnEE 
dateTimeEE 
.EE 
DateEE  
+EE! "
newEE# &
TimeSpanEE' /
(EE/ 0
hoursEE0 5
,EE5 6
minutesEE7 >
,EE> ?
secondsEE@ G
)EEG H
;EEH I
}FF 	
}GG 
}HH ∂
{F:\Work\Office\Projects\Nspira\Portal\HRMS_API\5-CrossCutting\Phoenix.CrossCutting.Utils\Extensions\EnumerableExtensions.cs
	namespace 	
Phonix
 
. 
CrossCutting 
. 
Utils #
{ 
public 

static 
class  
EnumerableExtensions ,
{ 
public 
static 
IEnumerable !
<! "
T" #
># $
EmptyIfNull% 0
<0 1
T1 2
>2 3
(3 4
this4 8
IEnumerable9 D
<D E
TE F
>F G

enumerableH R
)R S
{		 	
return

 

enumerable

 
??

  

Enumerable

! +
.

+ ,
Empty

, 1
<

1 2
T

2 3
>

3 4
(

4 5
)

5 6
;

6 7
} 	
} 
} ™
uF:\Work\Office\Projects\Nspira\Portal\HRMS_API\5-CrossCutting\Phoenix.CrossCutting.Utils\Extensions\EnumExtensions.cs
	namespace 	
Phonix
 
. 
CrossCutting 
. 
Utils #
{ 
public 

static 
class 
EnumExtensions &
{ 
public 
static 
string 
GetDescription +
(+ ,
this, 0
Enum1 5
value6 ;
); <
{		 	
if

 
(

 
value

 
==

 
null

 
)

 
{ 
return 
string 
. 
Empty #
;# $
} 
var 
	attribute 
= 
value !
.! "
GetAttribute" .
<. / 
DescriptionAttribute/ C
>C D
(D E
)E F
;F G
return 
( 
	attribute 
==  
null! %
)% &
?' (
value) .
.. /
ToString/ 7
(7 8
)8 9
:: ;
	attribute< E
.E F
DescriptionF Q
;Q R
} 	
private 
static 
T 
GetAttribute %
<% &
T& '
>' (
(( )
this) -
Enum. 2
value3 8
)8 9
where: ?
T@ A
:B C
	AttributeD M
{ 	
if 
( 
value 
== 
null 
) 
{ 
return 
null 
; 
} 
var 

memberInfo 
= 
value "
." #
GetType# *
(* +
)+ ,
., -
	GetMember- 6
(6 7
value7 <
.< =
ToString= E
(E F
)F G
)G H
;H I
var 

attributes 
= 

memberInfo '
[' (
$num( )
]) *
.* +
GetCustomAttributes+ >
(> ?
typeof? E
(E F
TF G
)G H
,H I
falseJ O
)O P
;P Q
return 
( 
T 
) 

attributes  
[  !
$num! "
]" #
;# $
} 	
}   
}!! £
zF:\Work\Office\Projects\Nspira\Portal\HRMS_API\5-CrossCutting\Phoenix.CrossCutting.Utils\Extensions\ExceptionExtensions.cs
	namespace 	
Phonix
 
. 
CrossCutting 
. 
Utils #
{ 
public 

static 
class 
ExceptionExtensions +
{ 
public		 
static		 
string		 
	GetDetail		 &
(		& '
this		' +
	Exception		, 5
	exception		6 ?
)		? @
{

 	
var 
sb 
= 
new 
StringBuilder &
(& '
)' (
;( )
sb 
. 
Append 
( 
$str "
)" #
.# $
Append$ *
(* +
	exception+ 4
.4 5
Message5 <
)< =
.= >
Append> D
(D E
$charE I
)I J
;J K
var 

stackFrame 
= 
new  

StackTrace! +
(+ ,
	exception, 5
,5 6
true7 ;
); <
.< =
GetFrame= E
(E F
$numF G
)G H
;H I
if 
( 

stackFrame 
== 
null "
)" #
{ 
return 
sb 
. 
ToString "
(" #
)# $
;$ %
} 
sb 
. 
Append 
( 
$str  
)  !
.! "
Append" (
(( )

stackFrame) 3
.3 4
	GetMethod4 =
(= >
)> ?
.? @
DeclaringType@ M
)M N
.N O
AppendO U
(U V
$charV Z
)Z [
;[ \
sb 
. 
Append 
( 
$str  
)  !
.! "
Append" (
(( )

stackFrame) 3
.3 4
GetFileLineNumber4 E
(E F
)F G
)G H
.H I
AppendI O
(O P
$charP T
)T U
;U V
return 
sb 
. 
ToString 
( 
)  
;  !
} 	
} 
} ˜
}F:\Work\Office\Projects\Nspira\Portal\HRMS_API\5-CrossCutting\Phoenix.CrossCutting.Utils\Extensions\PropertyInfoExtensions.cs
	namespace 	
Phonix
 
. 
CrossCutting 
. 
Utils #
{ 
public 

static 
class "
PropertyInfoExtensions .
{		 
public

 
static

 
IDictionary

 !
ToDictionary

" .
(

. /
this

/ 3
IEnumerable

4 ?
<

? @
PropertyInfo

@ L
>

L M

properties

N X
)

X Y
{ 	
return 

properties 
? 
. 
Where 
( 
property 
=>  "
!# $
string$ *
.* +
IsNullOrWhiteSpace+ =
(= >
property> F
.F G
GetValueG O
(O P
nullP T
)T U
asV X
stringY _
)_ `
)` a
. 
ToDictionary 
( 
property &
=>' )
property* 2
.2 3
Name3 7
.7 8
	CamelCase8 A
(A B
)B C
,C D
propertyE M
=>N P
propertyQ Y
.Y Z
GetValueZ b
(b c
nullc g
)g h
asi k
stringl r
)r s
;s t
} 	
} 
} ö!
zF:\Work\Office\Projects\Nspira\Portal\HRMS_API\5-CrossCutting\Phoenix.CrossCutting.Utils\Extensions\QueryableExtensions.cs
	namespace 	
Phonix
 
. 
CrossCutting 
. 
Utils #
{ 
public 

static 
class 
QueryableExtensions +
{ 
public		 
static		 

IQueryable		  
<		  !
T		! "
>		" #
Order		$ )
<		) *
T		* +
>		+ ,
(		, -
this		- 1

IQueryable		2 <
<		< =
T		= >
>		> ?
	queryable		@ I
,		I J
string		K Q
property		R Z
,		Z [
bool		\ `
isAscending		a l
)		l m
{

 	
if 
( 
	queryable 
? 
. 
Any 
( 
)  
!=! #
true$ (
||) +
string, 2
.2 3
IsNullOrEmpty3 @
(@ A
propertyA I
)I J
)J K
{ 
return 
	queryable  
;  !
} 
var 

expression 
= 
CreateExpression -
(- .
typeof. 4
(4 5
T5 6
)6 7
,7 8
property9 A
)A B
;B C
return 
isAscending 
?  
	Queryable! *
.* +
OrderBy+ 2
(2 3
	queryable3 <
,< =

expression> H
)H I
:J K
	QueryableL U
.U V
OrderByDescendingV g
(g h
	queryableh q
,q r

expressions }
)} ~
;~ 
} 	
public 
static 

IQueryable  
<  !
T! "
>" #
Page$ (
<( )
T) *
>* +
(+ ,
this, 0

IQueryable1 ;
<; <
T< =
>= >
	queryable? H
,H I
intJ M
indexN S
,S T
shortU Z
size[ _
)_ `
{ 	
if 
( 
	queryable 
? 
. 
Any 
( 
)  
!=! #
true$ (
||) +
index, 1
==2 4
$num5 6
||7 9
size: >
==? A
$numB C
)C D
{ 
return 
	queryable  
;  !
} 
return 
	queryable 
. 
Skip !
(! "
(" #
index# (
-) *
$num+ ,
), -
*. /
size0 4
)4 5
.5 6
Take6 :
(: ;
size; ?
)? @
;@ A
} 	
private 
static 
dynamic 
CreateExpression /
(/ 0
Type0 4
type5 9
,9 :
string; A
propertyB J
)J K
{   	
var!! 
	parameter!! 
=!! 

Expression!! &
.!!& '
	Parameter!!' 0
(!!0 1
type!!1 5
,!!5 6
$str!!7 :
)!!: ;
;!!; <

Expression## 
body## 
=## 
	parameter## '
;##' (
property%% 
.%% 
Split%% 
(%% 
$char%% 
)%% 
.%%  
ToList%%  &
(%%& '
)%%' (
.%%( )
ForEach%%) 0
(%%0 1
member%%1 7
=>%%8 :
body%%; ?
=%%@ A

Expression%%B L
.%%L M
PropertyOrField%%M \
(%%\ ]
body%%] a
,%%a b
member%%c i
)%%i j
)%%j k
;%%k l
return'' 

Expression'' 
.'' 
Lambda'' $
(''$ %
body''% )
,'') *
	parameter''+ 4
)''4 5
;''5 6
}(( 	
})) 
}** ≤+
wF:\Work\Office\Projects\Nspira\Portal\HRMS_API\5-CrossCutting\Phoenix.CrossCutting.Utils\Extensions\StringExtensions.cs
	namespace 	
Phonix
 
. 
CrossCutting 
. 
Utils #
{ 
public 

static 
class 
StringExtensions (
{ 
public		 
static		 
string		 
	CamelCase		 &
(		& '
this		' +
string		, 2
value		3 8
)		8 9
{

 	
return 
char 
. 
ToLowerInvariant (
(( )
value) .
[. /
$num/ 0
]0 1
)1 2
+3 4
value5 :
[: ;
$num; <
..< >
]> ?
;? @
} 	
public 
static 
string #
RemoveSpecialCharacters 4
(4 5
this5 9
string: @
valueA F
)F G
{ 	
var 

dictionary 
= 
new  

Dictionary! +
<+ ,
char, 0
,0 1
char2 6
[6 7
]7 8
>8 9
{ 
{ 
$char 
, 
new 
[ 
] 
{ 
$char  
,  !
$char" %
,% &
$char' *
,* +
$char, /
,/ 0
$char1 4
}4 5
}5 6
,6 7
{ 
$char 
, 
new 
[ 
] 
{ 
$char  
,  !
$char" %
,% &
$char' *
,* +
$char, /
,/ 0
$char1 4
}4 5
}5 6
,6 7
{ 
$char 
, 
new 
[ 
] 
{ 
$char  
}  !
}! "
," #
{ 
$char 
, 
new 
[ 
] 
{ 
$char  
}  !
}! "
," #
{ 
$char 
, 
new 
[ 
] 
{ 
$char  
,  !
$char" %
,% &
$char' *
,* +
$char, /
}/ 0
}0 1
,1 2
{ 
$char 
, 
new 
[ 
] 
{ 
$char  
,  !
$char" %
,% &
$char' *
,* +
$char, /
}/ 0
}0 1
,1 2
{ 
$char 
, 
new 
[ 
] 
{ 
$char  
,  !
$char" %
,% &
$char' *
,* +
$char, /
}/ 0
}0 1
,1 2
{ 
$char 
, 
new 
[ 
] 
{ 
$char  
,  !
$char" %
,% &
$char' *
,* +
$char, /
}/ 0
}0 1
,1 2
{ 
$char 
, 
new 
[ 
] 
{ 
$char  
,  !
$char" %
,% &
$char' *
,* +
$char, /
,/ 0
$char1 4
}4 5
}5 6
,6 7
{ 
$char 
, 
new 
[ 
] 
{ 
$char  
,  !
$char" %
,% &
$char' *
,* +
$char, /
,/ 0
$char1 4
}4 5
}5 6
,6 7
{ 
$char 
, 
new 
[ 
] 
{ 
$char  
,  !
$char" %
,% &
$char' *
,* +
$char, /
}/ 0
}0 1
,1 2
{ 
$char 
, 
new 
[ 
] 
{ 
$char  
,  !
$char" %
,% &
$char' *
,* +
$char, /
}/ 0
}0 1
,1 2
} 
; 
value   
=   

dictionary   
.   
Keys   #
.  # $
	Aggregate  $ -
(  - .
value  . 3
,  3 4
(  5 6
x  6 7
,  7 8
y  9 :
)  : ;
=>  < >

dictionary  ? I
[  I J
y  J K
]  K L
.  L M
	Aggregate  M V
(  V W
x  W X
,  X Y
(  Z [
z  [ \
,  \ ]
c  ^ _
)  _ `
=>  a c
z  d e
.  e f
Replace  f m
(  m n
c  n o
,  o p
y  q r
)  r s
)  s t
)  t u
;  u v
return"" 
new"" 
Regex"" 
("" 
$str"" 0
)""0 1
.""1 2
Replace""2 9
(""9 :
value"": ?
,""? @
string""A G
.""G H
Empty""H M
)""M N
;""N O
}## 	
}$$ 
}%% ó
yF:\Work\Office\Projects\Nspira\Portal\HRMS_API\5-CrossCutting\Phoenix.CrossCutting.Utils\Extensions\TimeSpanExtensions.cs
	namespace 	
Phonix
 
. 
CrossCutting 
. 
Utils #
{ 
public 

static 
class 
TimeSpanExtensions *
{ 
public 
static 
string 
Format #
(# $
this$ (
TimeSpan) 1
time2 6
)6 7
{		 	
var

 
days

 
=

 
(

 
time

 
.

 
Days

 !
>

" #
$num

$ %
)

% &
?

' (
$"

) +
{

+ ,
time

, 0
.

0 1
Days

1 5
}

5 6
$str

6 7
"

7 8
:

9 :
string

; A
.

A B
Empty

B G
;

G H
var 
hours 
= 
( 
time 
. 
Hours #
>$ %
$num& '
)' (
?) *
$"+ -
{- .
time. 2
.2 3
Hours3 8
}8 9
$str9 :
": ;
:< =
string> D
.D E
EmptyE J
;J K
var 
minutes 
= 
( 
time 
.  
Minutes  '
>( )
$num* +
)+ ,
?- .
$"/ 1
{1 2
time2 6
.6 7
Minutes7 >
}> ?
$str? @
"@ A
:B C
stringD J
.J K
EmptyK P
;P Q
var 
seconds 
= 
( 
time 
.  
Seconds  '
>( )
$num* +
)+ ,
?- .
$"/ 1
{1 2
time2 6
.6 7
Seconds7 >
}> ?
$str? @
"@ A
:B C
stringD J
.J K
EmptyK P
;P Q
return 
$" 
{ 
days 
} 
$str 
{ 
hours "
}" #
$str# $
{$ %
minutes% ,
}, -
$str- .
{. /
seconds/ 6
}6 7
"7 8
.8 9
Trim9 =
(= >
)> ?
;? @
} 	
public 
static 
TimeSpan 
NextTime '
(' (
this( ,
TimeSpan- 5
time6 :
,: ;
params< B
TimeSpanC K
[K L
]L M
timesN S
)S T
{ 	
return 
times 
. 
Where 
( 
x  
=>! #
x$ %
.% &
Hours& +
>, -
time. 2
.2 3
Hours3 8
)8 9
.9 :
OrderBy: A
(A B
xB C
=>D F
xG H
.H I
HoursI N
)N O
.O P
FirstOrDefaultP ^
(^ _
)_ `
;` a
} 	
} 
} ö
uF:\Work\Office\Projects\Nspira\Portal\HRMS_API\5-CrossCutting\Phoenix.CrossCutting.Utils\Extensions\TypeExtensions.cs
	namespace 	
Phonix
 
. 
CrossCutting 
. 
Utils #
{ 
public 

static 
class 
TypeExtensions &
{ 
public 
static 
IDictionary !
ToDictionary" .
(. /
this/ 3
Type4 8
type9 =
)= >
{		 	
return

 
type

 
?

 
.

 
GetProperties

 &
(

& '
)

' (
.

( )
ToDictionary

) 5
(

5 6
)

6 7
;

7 8
} 	
} 
} ﬂq
rF:\Work\Office\Projects\Nspira\Portal\HRMS_API\5-CrossCutting\Phoenix.CrossCutting.Utils\Interfaces\IRepository.cs
	namespace 	
Phonix
 
. 
CrossCutting 
. 
Utils #
{ 
public		 

	interface		 
IRepository		  
<		  !
TEntity		! (
>		( )
where		* /
TEntity		0 7
:		8 9
class		: ?
{

 

IQueryable 
< 
TEntity 
> 
	Queryable %
{& '
get( +
;+ ,
}- .
void 
Add 
( 
TEntity 
entity 
)  
;  !
Task 
AddAsync 
( 
TEntity 
entity $
)$ %
;% &
void 
AddRange 
( 
params 
TEntity $
[$ %
]% &
entities' /
)/ 0
;0 1
Task 
AddRangeAsync 
( 
params !
TEntity" )
[) *
]* +
entities, 4
)4 5
;5 6
bool 
Any 
( 
) 
; 
bool 
Any 
( 

Expression 
< 
Func  
<  !
TEntity! (
,( )
bool* .
>. /
>/ 0
where1 6
)6 7
;7 8
Task 
< 
bool 
> 
AnyAsync 
( 
) 
; 
Task 
< 
bool 
> 
AnyAsync 
( 

Expression &
<& '
Func' +
<+ ,
TEntity, 3
,3 4
bool5 9
>9 :
>: ;
where< A
)A B
;B C
long 
Count 
( 
) 
; 
long 
Count 
( 

Expression 
< 
Func "
<" #
TEntity# *
,* +
bool, 0
>0 1
>1 2
where3 8
)8 9
;9 :
Task!! 
<!! 
long!! 
>!! 

CountAsync!! 
(!! 
)!! 
;!!  
Task## 
<## 
long## 
>## 

CountAsync## 
(## 

Expression## (
<##( )
Func##) -
<##- .
TEntity##. 5
,##5 6
bool##7 ;
>##; <
>##< =
where##> C
)##C D
;##D E
void%% 
Delete%% 
(%% 
object%% 
key%% 
)%% 
;%%  
TEntity'' 
FirstOrDefault'' 
('' 
params'' %

Expression''& 0
<''0 1
Func''1 5
<''5 6
TEntity''6 =
,''= >
object''? E
>''E F
>''F G
[''G H
]''H I
include''J Q
)''Q R
;''R S
TEntity)) 
FirstOrDefault)) 
()) 

Expression)) )
<))) *
Func))* .
<)). /
TEntity))/ 6
,))6 7
bool))8 <
>))< =
>))= >
where))? D
,))D E
params))F L

Expression))M W
<))W X
Func))X \
<))\ ]
TEntity))] d
,))d e
object))f l
>))l m
>))m n
[))n o
]))o p
include))q x
)))x y
;))y z
Task++ 
<++ 
TEntity++ 
>++ 
FirstOrDefaultAsync++ )
(++) *
params++* 0

Expression++1 ;
<++; <
Func++< @
<++@ A
TEntity++A H
,++H I
object++J P
>++P Q
>++Q R
[++R S
]++S T
include++U \
)++\ ]
;++] ^
Task-- 
<-- 
TEntity-- 
>-- 
FirstOrDefaultAsync-- )
(--) *

Expression--* 4
<--4 5
Func--5 9
<--9 :
TEntity--: A
,--A B
bool--C G
>--G H
>--H I
where--J O
,--O P
params--Q W

Expression--X b
<--b c
Func--c g
<--g h
TEntity--h o
,--o p
object--q w
>--w x
>--x y
[--y z
]--z {
include	--| É
)
--É Ñ
;
--Ñ Ö
TEntityResult//  
FirstOrDefaultResult// *
<//* +
TEntityResult//+ 8
>//8 9
(//9 :

Expression//: D
<//D E
Func//E I
<//I J
TEntity//J Q
,//Q R
bool//S W
>//W X
>//X Y
where//Z _
,//_ `

Expression//a k
<//k l
Func//l p
<//p q
TEntity//q x
,//x y
TEntityResult	//z á
>
//á à
>
//à â
select
//ä ê
)
//ê ë
;
//ë í
Task11 
<11 
TEntityResult11 
>11 %
FirstOrDefaultResultAsync11 5
<115 6
TEntityResult116 C
>11C D
(11D E

Expression11E O
<11O P
Func11P T
<11T U
TEntity11U \
,11\ ]
bool11^ b
>11b c
>11c d
where11e j
,11j k

Expression11l v
<11v w
Func11w {
<11{ |
TEntity	11| É
,
11É Ñ
TEntityResult
11Ö í
>
11í ì
>
11ì î
select
11ï õ
)
11õ ú
;
11ú ù
TEntity33 
LastOrDefault33 
(33 
params33 $

Expression33% /
<33/ 0
Func330 4
<334 5
TEntity335 <
,33< =
object33> D
>33D E
>33E F
[33F G
]33G H
include33I P
)33P Q
;33Q R
TEntity55 
LastOrDefault55 
(55 

Expression55 (
<55( )
Func55) -
<55- .
TEntity55. 5
,555 6
bool557 ;
>55; <
>55< =
where55> C
,55C D
params55E K

Expression55L V
<55V W
Func55W [
<55[ \
TEntity55\ c
,55c d
object55e k
>55k l
>55l m
[55m n
]55n o
include55p w
)55w x
;55x y
Task77 
<77 
TEntity77 
>77 
LastOrDefaultAsync77 (
(77( )
params77) /

Expression770 :
<77: ;
Func77; ?
<77? @
TEntity77@ G
,77G H
object77I O
>77O P
>77P Q
[77Q R
]77R S
include77T [
)77[ \
;77\ ]
Task99 
<99 
TEntity99 
>99 
LastOrDefaultAsync99 (
(99( )

Expression99) 3
<993 4
Func994 8
<998 9
TEntity999 @
,99@ A
bool99B F
>99F G
>99G H
where99I N
,99N O
params99P V

Expression99W a
<99a b
Func99b f
<99f g
TEntity99g n
,99n o
object99p v
>99v w
>99w x
[99x y
]99y z
include	99{ Ç
)
99Ç É
;
99É Ñ
TEntityResult;; 
LastOrDefaultResult;; )
<;;) *
TEntityResult;;* 7
>;;7 8
(;;8 9

Expression;;9 C
<;;C D
Func;;D H
<;;H I
TEntity;;I P
,;;P Q
bool;;R V
>;;V W
>;;W X
where;;Y ^
,;;^ _

Expression;;` j
<;;j k
Func;;k o
<;;o p
TEntity;;p w
,;;w x
TEntityResult	;;y Ü
>
;;Ü á
>
;;á à
select
;;â è
)
;;è ê
;
;;ê ë
Task== 
<== 
TEntityResult== 
>== $
LastOrDefaultResultAsync== 4
<==4 5
TEntityResult==5 B
>==B C
(==C D

Expression==D N
<==N O
Func==O S
<==S T
TEntity==T [
,==[ \
bool==] a
>==a b
>==b c
where==d i
,==i j

Expression==k u
<==u v
Func==v z
<==z {
TEntity	=={ Ç
,
==Ç É
TEntityResult
==Ñ ë
>
==ë í
>
==í ì
select
==î ö
)
==ö õ
;
==õ ú
IEnumerable?? 
<?? 
TEntity?? 
>?? 
List?? !
(??! "
params??" (

Expression??) 3
<??3 4
Func??4 8
<??8 9
TEntity??9 @
,??@ A
object??B H
>??H I
>??I J
[??J K
]??K L
include??M T
)??T U
;??U V
IEnumerableAA 
<AA 
TEntityAA 
>AA 
ListAA !
(AA! "

ExpressionAA" ,
<AA, -
FuncAA- 1
<AA1 2
TEntityAA2 9
,AA9 :
boolAA; ?
>AA? @
>AA@ A
whereAAB G
,AAG H
paramsAAI O

ExpressionAAP Z
<AAZ [
FuncAA[ _
<AA_ `
TEntityAA` g
,AAg h
objectAAi o
>AAo p
>AAp q
[AAq r
]AAr s
includeAAt {
)AA{ |
;AA| }
	PagedListCC 
<CC 
TEntityCC 
>CC 
ListCC 
(CC  
PagedListParametersCC  3

parametersCC4 >
,CC> ?
paramsCC@ F

ExpressionCCG Q
<CCQ R
FuncCCR V
<CCV W
TEntityCCW ^
,CC^ _
objectCC` f
>CCf g
>CCg h
[CCh i
]CCi j
includeCCk r
)CCr s
;CCs t
	PagedListEE 
<EE 
TEntityEE 
>EE 
ListEE 
(EE  
PagedListParametersEE  3

parametersEE4 >
,EE> ?

ExpressionEE@ J
<EEJ K
FuncEEK O
<EEO P
TEntityEEP W
,EEW X
boolEEY ]
>EE] ^
>EE^ _
whereEE` e
,EEe f
paramsEEg m

ExpressionEEn x
<EEx y
FuncEEy }
<EE} ~
TEntity	EE~ Ö
,
EEÖ Ü
object
EEá ç
>
EEç é
>
EEé è
[
EEè ê
]
EEê ë
include
EEí ô
)
EEô ö
;
EEö õ
TaskGG 
<GG 
IEnumerableGG 
<GG 
TEntityGG  
>GG  !
>GG! "
	ListAsyncGG# ,
(GG, -
paramsGG- 3

ExpressionGG4 >
<GG> ?
FuncGG? C
<GGC D
TEntityGGD K
,GGK L
objectGGM S
>GGS T
>GGT U
[GGU V
]GGV W
includeGGX _
)GG_ `
;GG` a
TaskII 
<II 
IEnumerableII 
<II 
TEntityII  
>II  !
>II! "
	ListAsyncII# ,
(II, -

ExpressionII- 7
<II7 8
FuncII8 <
<II< =
TEntityII= D
,IID E
boolIIF J
>IIJ K
>IIK L
whereIIM R
,IIR S
paramsIIT Z

ExpressionII[ e
<IIe f
FuncIIf j
<IIj k
TEntityIIk r
,IIr s
objectIIt z
>IIz {
>II{ |
[II| }
]II} ~
include	II Ü
)
IIÜ á
;
IIá à
TEntityKK 
SelectKK 
(KK 
longKK 
idKK 
)KK 
;KK  
TaskMM 
<MM 
TEntityMM 
>MM 
SelectAsyncMM !
(MM! "
longMM" &
idMM' )
)MM) *
;MM* +
TEntityOO 
SingleOrDefaultOO 
(OO  

ExpressionOO  *
<OO* +
FuncOO+ /
<OO/ 0
TEntityOO0 7
,OO7 8
boolOO9 =
>OO= >
>OO> ?
whereOO@ E
,OOE F
paramsOOG M

ExpressionOON X
<OOX Y
FuncOOY ]
<OO] ^
TEntityOO^ e
,OOe f
objectOOg m
>OOm n
>OOn o
[OOo p
]OOp q
includeOOr y
)OOy z
;OOz {
TaskQQ 
<QQ 
TEntityQQ 
>QQ  
SingleOrDefaultAsyncQQ *
(QQ* +

ExpressionQQ+ 5
<QQ5 6
FuncQQ6 :
<QQ: ;
TEntityQQ; B
,QQB C
boolQQD H
>QQH I
>QQI J
whereQQK P
,QQP Q
paramsQQR X

ExpressionQQY c
<QQc d
FuncQQd h
<QQh i
TEntityQQi p
,QQp q
objectQQr x
>QQx y
>QQy z
[QQz {
]QQ{ |
include	QQ} Ñ
)
QQÑ Ö
;
QQÖ Ü
TEntityResultSS !
SingleOrDefaultResultSS +
<SS+ ,
TEntityResultSS, 9
>SS9 :
(SS: ;

ExpressionSS; E
<SSE F
FuncSSF J
<SSJ K
TEntitySSK R
,SSR S
boolSST X
>SSX Y
>SSY Z
whereSS[ `
,SS` a

ExpressionSSb l
<SSl m
FuncSSm q
<SSq r
TEntitySSr y
,SSy z
TEntityResult	SS{ à
>
SSà â
>
SSâ ä
select
SSã ë
)
SSë í
;
SSí ì
TaskUU 
<UU 
TEntityResultUU 
>UU &
SingleOrDefaultResultAsyncUU 6
<UU6 7
TEntityResultUU7 D
>UUD E
(UUE F

ExpressionUUF P
<UUP Q
FuncUUQ U
<UUU V
TEntityUUV ]
,UU] ^
boolUU_ c
>UUc d
>UUd e
whereUUf k
,UUk l

ExpressionUUm w
<UUw x
FuncUUx |
<UU| }
TEntity	UU} Ñ
,
UUÑ Ö
TEntityResult
UUÜ ì
>
UUì î
>
UUî ï
select
UUñ ú
)
UUú ù
;
UUù û
voidWW 
UpdateWW 
(WW 
TEntityWW 
entityWW "
,WW" #
objectWW$ *
keyWW+ .
)WW. /
;WW/ 0
}XX 
}YY å
kF:\Work\Office\Projects\Nspira\Portal\HRMS_API\5-CrossCutting\Phoenix.CrossCutting.Utils\PagedList\Order.cs
	namespace 	
Phonix
 
. 
CrossCutting 
. 
Utils #
{ 
public 

class 
Order 
{ 
public 
bool 
IsAscending 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
Property 
{  
get! $
;$ %
set& )
;) *
}+ ,
} 
}		 ˛
jF:\Work\Office\Projects\Nspira\Portal\HRMS_API\5-CrossCutting\Phoenix.CrossCutting.Utils\PagedList\Page.cs
	namespace 	
Phonix
 
. 
CrossCutting 
. 
Utils #
{ 
public 

class 
Page 
{ 
public 
int 
Index 
{ 
get 
; 
set  #
;# $
}% &
public 
short 
Size 
{ 
get 
;  
set! $
;$ %
}& '
} 
}		 Ÿ
oF:\Work\Office\Projects\Nspira\Portal\HRMS_API\5-CrossCutting\Phoenix.CrossCutting.Utils\PagedList\PagedList.cs
	namespace 	
Phonix
 
. 
CrossCutting 
. 
Utils #
{ 
public 

class 
	PagedList 
< 
T 
> 
{ 
public 
	PagedList 
( 

IQueryable #
<# $
T$ %
>% &
	queryable' 0
,0 1
PagedListParameters2 E

parametersF P
)P Q
{		 	
if

 
(

 
	queryable

 
==

 
null

 !
)

! "
{ 
return 
; 
} 
this 
. 
Count 
= 
	queryable "
." #
	LongCount# ,
(, -
)- .
;. /

parameters 
? 
. 
Orders 
? 
.  
ToList  &
(& '
)' (
.( )
ForEach) 0
(0 1
order1 6
=>7 9
	queryable: C
=D E
	queryableF O
.O P
OrderP U
(U V
orderV [
.[ \
Property\ d
,d e
orderf k
.k l
IsAscendingl w
)w x
)x y
;y z
if 
( 

parameters 
? 
. 
Page  
!=! #
null$ (
)( )
{ 
	queryable 
= 
	queryable %
?% &
.& '
Page' +
(+ ,

parameters, 6
.6 7
Page7 ;
.; <
Index< A
,A B

parametersC M
.M N
PageN R
.R S
SizeS W
)W X
;X Y
} 
this 
. 
List 
= 
	queryable !
.! "
AsEnumerable" .
(. /
)/ 0
;0 1
} 	
public 
long 
Count 
{ 
get 
;  
}! "
public 
IEnumerable 
< 
T 
> 
List "
{# $
get% (
;( )
}* +
} 
} æ
yF:\Work\Office\Projects\Nspira\Portal\HRMS_API\5-CrossCutting\Phoenix.CrossCutting.Utils\PagedList\PagedListParameters.cs
	namespace 	
Phonix
 
. 
CrossCutting 
. 
Utils #
{ 
public 

class 
PagedListParameters $
{ 
public 
IList 
< 
Order 
> 
Orders "
{# $
get% (
;( )
set* -
;- .
}/ 0
=1 2
new3 6
List7 ;
<; <
Order< A
>A B
(B C
)C D
;D E
public		 
Page		 
Page		 
{		 
get		 
;		 
set		  #
;		# $
}		% &
=		' (
new		) ,
Page		- 1
(		1 2
)		2 3
;		3 4
}

 
} âÃ
pF:\Work\Office\Projects\Nspira\Portal\HRMS_API\5-CrossCutting\Phoenix.CrossCutting.Utils\Token\JwtAuthManager.cs
	namespace 	
Phonix
 
. 
CrossCutting 
. 
Utils #
.# $
Token$ )
{ 
public 

	interface 
IJwtAuthManager $
{  
IImmutableDictionary 
< 
string #
,# $
RefreshToken% 1
>1 20
$UsersRefreshTokensReadOnlyDictionary3 W
{X Y
getZ ]
;] ^
}_ `
JwtAuthResult 
GenerateTokens $
($ %
string% +
username, 4
,4 5
Claim6 ;
[; <
]< =
claims> D
,D E
DateTimeF N
nowO R
)R S
;S T
JwtAuthResult 
GenerateToken #
(# $
UserInformation$ 3
user4 8
)8 9
;9 :
JwtAuthResult 
Refresh 
( 
UserInformation -
userInformation. =
)= >
;> ?
void &
RemoveExpiredRefreshTokens '
(' (
DateTime( 0
now1 4
)4 5
;5 6
void (
RemoveRefreshTokenByUserName )
() *
string* 0
userName1 9
)9 :
;: ;
(!! 	
ClaimsPrincipal!!	 
,!! 
JwtSecurityToken!! *
)!!* +
DecodeJwtToken!!, :
(!!: ;
string!!; A
token!!B G
)!!G H
;!!H I
bool"" 
ValidateToken"" 
("" 
string"" !
token""" '
)""' (
;""( )
}## 
public%% 

class%% 
JwtAuthManager%% 
:%%  !
IJwtAuthManager%%" 1
{&& 
public''  
IImmutableDictionary'' #
<''# $
string''$ *
,''* +
RefreshToken'', 8
>''8 90
$UsersRefreshTokensReadOnlyDictionary'': ^
=>''_ a
this''b f
.''f g
usersRefreshTokens''g y
.''y z"
ToImmutableDictionary	''z è
(
''è ê
)
''ê ë
;
''ë í
private)) 
readonly))  
ConcurrentDictionary)) -
<))- .
string)). 4
,))4 5
RefreshToken))6 B
>))B C
usersRefreshTokens))D V
;))V W
private** 
readonly** 
byte** 
[** 
]** 
secret**  &
;**& '
public,, 
JwtAuthManager,, 
(,, 
),, 
{-- 	
this.. 
... 
usersRefreshTokens.. #
=..$ %
new..& ) 
ConcurrentDictionary..* >
<..> ?
string..? E
,..E F
RefreshToken..G S
>..S T
(..T U
)..U V
;..V W
this// 
.// 
secret// 
=// 
Encoding// "
.//" #
ASCII//# (
.//( )
GetBytes//) 1
(//1 2!
JwtTokenConfiguration//2 G
.//G H
Current//H O
.//O P
JwtKey//P V
)//V W
;//W X
}00 	
public33 
void33 &
RemoveExpiredRefreshTokens33 .
(33. /
DateTime33/ 7
now338 ;
)33; <
{44 	
var55 
expiredTokens55 
=55 
this55  $
.55$ %
usersRefreshTokens55% 7
.557 8
Where558 =
(55= >
x55> ?
=>55@ B
x55C D
.55D E
Value55E J
.55J K
ExpireAt55K S
<55T U
now55V Y
)55Y Z
.55Z [
ToList55[ a
(55a b
)55b c
;55c d
foreach66 
(66 
var66 
expiredToken66 %
in66& (
expiredTokens66) 6
)666 7
{77 
this88 
.88 
usersRefreshTokens88 '
.88' (
	TryRemove88( 1
(881 2
expiredToken882 >
.88> ?
Key88? B
,88B C
out88D G
_88H I
)88I J
;88J K
}99 
}:: 	
public== 
void== (
RemoveRefreshTokenByUserName== 0
(==0 1
string==1 7
userName==8 @
)==@ A
{>> 	
var?? 
refreshTokens?? 
=?? 
this??  $
.??$ %
usersRefreshTokens??% 7
.??7 8
Where??8 =
(??= >
x??> ?
=>??@ B
x??C D
.??D E
Value??E J
.??J K
UserName??K S
==??T V
userName??W _
)??_ `
.??` a
ToList??a g
(??g h
)??h i
;??i j
foreach@@ 
(@@ 
var@@ 
refreshToken@@ %
in@@& (
refreshTokens@@) 6
)@@6 7
{AA 
thisBB 
.BB 
usersRefreshTokensBB '
.BB' (
	TryRemoveBB( 1
(BB1 2
refreshTokenBB2 >
.BB> ?
KeyBB? B
,BBB C
outBBD G
_BBH I
)BBI J
;BBJ K
}CC 
}DD 	
publicFF 
JwtAuthResultFF 
GenerateTokensFF +
(FF+ ,
stringFF, 2
usernameFF3 ;
,FF; <
ClaimFF= B
[FFB C
]FFC D
claimsFFE K
,FFK L
DateTimeFFM U
nowFFV Y
)FFY Z
{GG 	
varHH "
shouldAddAudienceClaimHH &
=HH' (
stringHH) /
.HH/ 0
IsNullOrWhiteSpaceHH0 B
(HHB C
claimsHHC I
?HHI J
.HHJ K
FirstOrDefaultHHK Y
(HHY Z
xHHZ [
=>HH\ ^
xHH_ `
.HH` a
TypeHHa e
==HHf h$
JwtRegisteredClaimNames	HHi Ä
.
HHÄ Å
Aud
HHÅ Ñ
)
HHÑ Ö
?
HHÖ Ü
.
HHÜ á
Value
HHá å
)
HHå ç
;
HHç é
varII 
jwtTokenII 
=II 
newII 
JwtSecurityTokenII /
(II/ 0!
JwtTokenConfigurationJJ %
.JJ% &
CurrentJJ& -
.JJ- .
	JwtIssuerJJ. 7
,JJ7 8"
shouldAddAudienceClaimKK &
?KK' (!
JwtTokenConfigurationKK) >
.KK> ?
CurrentKK? F
.KKF G
JwtaudienceKKG R
:KKS T
stringKKU [
.KK[ \
EmptyKK\ a
,KKa b
claimsLL 
,LL 
expiresMM 
:MM 
nowMM 
.MM 
AddHoursMM %
(MM% &!
JwtTokenConfigurationMM& ;
.MM; <
CurrentMM< C
.MMC D
	JwtExpireMMD M
.MMM N
ToDoubleOrDefaultMMN _
(MM_ `
)MM` a
)MMa b
,MMb c
signingCredentialsNN "
:NN" #
newNN$ '
SigningCredentialsNN( :
(NN: ;
newNN; > 
SymmetricSecurityKeyNN? S
(NNS T
thisNNT X
.NNX Y
secretNNY _
)NN_ `
,NN` a
SecurityAlgorithmsNNb t
.NNt u 
HmacSha256Signature	NNu à
)
NNà â
)
NNâ ä
;
NNä ã
varOO 
accessTokenOO 
=OO 
newOO !#
JwtSecurityTokenHandlerOO" 9
(OO9 :
)OO: ;
.OO; <

WriteTokenOO< F
(OOF G
jwtTokenOOG O
)OOO P
;OOP Q
varQQ 
refreshTokenQQ 
=QQ 
newQQ "
RefreshTokenQQ# /
{RR 
UserNameSS 
=SS 
usernameSS #
,SS# $
TokenStringTT 
=TT &
GenerateRefreshTokenStringTT 8
(TT8 9
)TT9 :
,TT: ;
ExpireAtUU 
=UU 
nowUU 
.UU 
AddHoursUU '
(UU' (!
JwtTokenConfigurationUU( =
.UU= >
CurrentUU> E
.UUE F"
refreshTokenExpirationUUF \
.UU\ ]
ToDoubleOrDefaultUU] n
(UUn o
)UUo p
)UUp q
,UUq r
}VV 
;VV 
thisWW 
.WW 
usersRefreshTokensWW #
.WW# $
AddOrUpdateWW$ /
(WW/ 0
refreshTokenWW0 <
.WW< =
TokenStringWW= H
,WWH I
refreshTokenWWJ V
,WWV W
(WWX Y
_WWY Z
,WWZ [
_WW\ ]
)WW] ^
=>WW_ a
refreshTokenWWb n
)WWn o
;WWo p
returnYY 
newYY 
JwtAuthResultYY $
{ZZ 
AccessToken[[ 
=[[ 
accessToken[[ )
,[[) *
RefreshToken\\ 
=\\ 
refreshToken\\ +
,\\+ ,
}]] 
;]] 
}^^ 	
public`` 
JwtAuthResult`` 
Refresh`` $
(``$ %
UserInformation``% 4
userInformation``5 D
)``D E
{aa 	
varbb 

principal2bb 
=bb 
thisbb !
.bb! "(
GetPrincipalFromExpiredTokenbb" >
(bb> ?
userInformationbb? N
.bbN O
TokenbbO T
)bbT U
;bbU V
varcc 
(cc 
	principalcc 
,cc 
jwtTokencc %
)cc% &
=cc' (
thiscc) -
.cc- .
DecodeJwtTokencc. <
(cc< =
userInformationcc= L
.ccL M
TokenccM R
)ccR S
;ccS T
varii 
userNameii 
=ii 
	principalii $
.ii$ %
Identityii% -
?ii- .
.ii. /
Nameii/ 3
;ii3 4
ifjj 
(jj 
!jj 
thisjj 
.jj 
usersRefreshTokensjj (
.jj( )
TryGetValuejj) 4
(jj4 5
userInformationjj5 D
.jjD E
RefreshTokenjjE Q
.jjQ R
TokenStringjjR ]
,jj] ^
outjj_ b
varjjc f 
existingRefreshTokenjjg {
)jj{ |
)jj| }
{kk 
throwll 
newll "
SecurityTokenExceptionll 0
(ll0 1
$strll1 @
)ll@ A
;llA B
}mm 
ifnn 
(nn  
existingRefreshTokennn $
.nn$ %
UserNamenn% -
!=nn. 0
userNamenn1 9
||nn: < 
existingRefreshTokennn= Q
.nnQ R
ExpireAtnnR Z
<nn[ \
DateTimenn] e
.nne f
Nownnf i
)nni j
{oo 
throwpp 
newpp "
SecurityTokenExceptionpp 0
(pp0 1
$strpp1 @
)pp@ A
;ppA B
}qq 
returnss 
thisss 
.ss 
GenerateTokenss %
(ss% &
userInformationss& 5
)ss5 6
;ss6 7
}tt 	
publicuu 
ClaimsPrincipaluu (
GetPrincipalFromExpiredTokenuu ;
(uu; <
stringuu< B
tokenuuC H
)uuH I
{vv 	
varww 
mySecretww 
=ww 
Encodingww #
.ww# $
UTF8ww$ (
.ww( )
GetBytesww) 1
(ww1 2!
JwtTokenConfigurationww2 G
.wwG H
CurrentwwH O
.wwO P
JwtKeywwP V
)wwV W
;wwW X
varxx 
mySecurityKeyxx 
=xx 
newxx  # 
SymmetricSecurityKeyxx$ 8
(xx8 9
mySecretxx9 A
)xxA B
;xxB C
varyy %
tokenValidationParametersyy )
=yy* +
newyy, /%
TokenValidationParametersyy0 I
{zz $
ValidateIssuerSigningKey{{ (
={{) *
true{{+ /
,{{/ 0
ValidateIssuer|| 
=||  
true||! %
,||% &
ValidateAudience}}  
=}}! "
true}}# '
,}}' (
ValidateLifetime~~  
=~~! "
true~~# '
,~~' (
ValidIssuer 
= !
JwtTokenConfiguration 3
.3 4
Current4 ;
.; <
	JwtIssuer< E
,E F
ValidAudience
ÄÄ 
=
ÄÄ #
JwtTokenConfiguration
ÄÄ  5
.
ÄÄ5 6
Current
ÄÄ6 =
.
ÄÄ= >
Jwtaudience
ÄÄ> I
,
ÄÄI J
IssuerSigningKey
ÅÅ  
=
ÅÅ! "
mySecurityKey
ÅÅ# 0
,
ÅÅ0 1
}
ÇÇ 
;
ÇÇ 
var
ÉÉ 
tokenHandler
ÉÉ 
=
ÉÉ 
new
ÉÉ "%
JwtSecurityTokenHandler
ÉÉ# :
(
ÉÉ: ;
)
ÉÉ; <
;
ÉÉ< =
SecurityToken
ÑÑ 
securityToken
ÑÑ '
;
ÑÑ' (
var
ÖÖ 
	principal
ÖÖ 
=
ÖÖ 
tokenHandler
ÖÖ (
.
ÖÖ( )
ValidateToken
ÖÖ) 6
(
ÖÖ6 7
token
ÖÖ7 <
,
ÖÖ< ='
tokenValidationParameters
ÖÖ> W
,
ÖÖW X
out
ÖÖY \
securityToken
ÖÖ] j
)
ÖÖj k
;
ÖÖk l
var
ÜÜ 
jwtSecurityToken
ÜÜ  
=
ÜÜ! "
securityToken
ÜÜ# 0
as
ÜÜ1 3
JwtSecurityToken
ÜÜ4 D
;
ÜÜD E
return
ââ 
	principal
ââ 
;
ââ 
}
ää 	
public
ãã 
(
ãã 
ClaimsPrincipal
ãã 
,
ãã  
JwtSecurityToken
ãã! 1
)
ãã1 2
DecodeJwtToken
ãã3 A
(
ããA B
string
ããB H
token
ããI N
)
ããN O
{
åå 	
if
çç 
(
çç 
string
çç 
.
çç  
IsNullOrWhiteSpace
çç )
(
çç) *
token
çç* /
)
çç/ 0
)
çç0 1
{
éé 
throw
èè 
new
èè $
SecurityTokenException
èè 0
(
èè0 1
$str
èè1 @
)
èè@ A
;
èèA B
}
êê 
var
ëë 
mySecret
ëë 
=
ëë 
Encoding
ëë #
.
ëë# $
UTF8
ëë$ (
.
ëë( )
GetBytes
ëë) 1
(
ëë1 2#
JwtTokenConfiguration
ëë2 G
.
ëëG H
Current
ëëH O
.
ëëO P
JwtKey
ëëP V
)
ëëV W
;
ëëW X
var
íí 
mySecurityKey
íí 
=
íí 
new
íí  #"
SymmetricSecurityKey
íí$ 8
(
íí8 9
mySecret
íí9 A
)
ííA B
;
ííB C
var
ìì 
	principal
ìì 
=
ìì 
new
ìì %
JwtSecurityTokenHandler
ìì  7
(
ìì7 8
)
ìì8 9
.
îî 
ValidateToken
îî 
(
îî 
token
îî $
,
îî$ %
new
ïï '
TokenValidationParameters
ïï 1
{
ññ 
ValidateIssuer
óó &
=
óó' (
true
óó) -
,
óó- .
ValidIssuer
òò #
=
òò$ %#
JwtTokenConfiguration
òò& ;
.
òò; <
Current
òò< C
.
òòC D
	JwtIssuer
òòD M
,
òòM N&
ValidateIssuerSigningKey
ôô 0
=
ôô1 2
true
ôô3 7
,
ôô7 8
IssuerSigningKey
öö (
=
öö) *
mySecurityKey
öö+ 8
,
öö8 9
ValidAudience
õõ %
=
õõ& '#
JwtTokenConfiguration
õõ( =
.
õõ= >
Current
õõ> E
.
õõE F
Jwtaudience
õõF Q
,
õõQ R
ValidateAudience
úú (
=
úú) *
true
úú+ /
,
úú/ 0
ValidateLifetime
ùù (
=
ùù) *
true
ùù+ /
,
ùù/ 0
	ClockSkew
ûû !
=
ûû" #
TimeSpan
ûû$ ,
.
ûû, -
FromMinutes
ûû- 8
(
ûû8 9
$num
ûû9 :
)
ûû: ;
,
ûû; <
}
üü 
,
üü 
out
†† 
SecurityToken
†† %
validatedToken
††& 4
)
††4 5
;
††5 6
return
°° 
(
°° 
	principal
°° 
,
°° 
validatedToken
°° -
as
°°. 0
JwtSecurityToken
°°1 A
)
°°A B
;
°°B C
}
¢¢ 	
private
§§ 
static
§§ 
string
§§ (
GenerateRefreshTokenString
§§ 8
(
§§8 9
)
§§9 :
{
•• 	
var
¶¶ 
randomNumber
¶¶ 
=
¶¶ 
new
¶¶ "
byte
¶¶# '
[
¶¶' (
$num
¶¶( *
]
¶¶* +
;
¶¶+ ,
using
ßß 
var
ßß #
randomNumberGenerator
ßß +
=
ßß, -#
RandomNumberGenerator
ßß. C
.
ßßC D
Create
ßßD J
(
ßßJ K
)
ßßK L
;
ßßL M#
randomNumberGenerator
®® !
.
®®! "
GetBytes
®®" *
(
®®* +
randomNumber
®®+ 7
)
®®7 8
;
®®8 9
return
©© 
Convert
©© 
.
©© 
ToBase64String
©© )
(
©©) *
randomNumber
©©* 6
)
©©6 7
;
©©7 8
}
™™ 	
public
¨¨ 
JwtAuthResult
¨¨ 
GenerateToken
¨¨ *
(
¨¨* +
UserInformation
¨¨+ :
user
¨¨; ?
)
¨¨? @
{
≠≠ 	
Claim
ÆÆ 
[
ÆÆ 
]
ÆÆ 
generateClaims
ÆÆ "
=
ÆÆ# $
GenerateClaims
ÆÆ% 3
(
ÆÆ3 4
user
ÆÆ4 8
)
ÆÆ8 9
;
ÆÆ9 :
var
ØØ $
shouldAddAudienceClaim
ØØ &
=
ØØ' (
string
ØØ) /
.
ØØ/ 0 
IsNullOrWhiteSpace
ØØ0 B
(
ØØB C
generateClaims
ØØC Q
?
ØØQ R
.
ØØR S
FirstOrDefault
ØØS a
(
ØØa b
x
ØØb c
=>
ØØd f
x
ØØg h
.
ØØh i
Type
ØØi m
==
ØØn p&
JwtRegisteredClaimNamesØØq à
.ØØà â
AudØØâ å
)ØØå ç
?ØØç é
.ØØé è
ValueØØè î
)ØØî ï
;ØØï ñ
var
∞∞ 
jwtToken
∞∞ 
=
∞∞ 
new
∞∞ 
JwtSecurityToken
∞∞ /
(
∞∞/ 0#
JwtTokenConfiguration
±± $
.
±±$ %
Current
±±% ,
.
±±, -
	JwtIssuer
±±- 6
,
±±6 7$
shouldAddAudienceClaim
≤≤ &
?
≤≤' (#
JwtTokenConfiguration
≤≤) >
.
≤≤> ?
Current
≤≤? F
.
≤≤F G
Jwtaudience
≤≤G R
:
≤≤S T
string
≤≤U [
.
≤≤[ \
Empty
≤≤\ a
,
≤≤a b
generateClaims
≥≥ 
,
≥≥ 
expires
¥¥ 
:
¥¥ 
DateTime
¥¥ !
.
¥¥! "
Now
¥¥" %
.
¥¥% &
AddHours
¥¥& .
(
¥¥. /#
JwtTokenConfiguration
¥¥/ D
.
¥¥D E
Current
¥¥E L
.
¥¥L M
	JwtExpire
¥¥M V
.
¥¥V W
ToDoubleOrDefault
¥¥W h
(
¥¥h i
)
¥¥i j
)
¥¥j k
,
¥¥k l 
signingCredentials
µµ "
:
µµ" #
new
µµ$ ' 
SigningCredentials
µµ( :
(
µµ: ;
new
µµ; >"
SymmetricSecurityKey
µµ? S
(
µµS T
this
µµT X
.
µµX Y
secret
µµY _
)
µµ_ `
,
µµ` a 
SecurityAlgorithms
µµb t
.
µµt u"
HmacSha256Signatureµµu à
)µµà â
)µµâ ä
;µµä ã
var
∂∂ 
accessToken
∂∂ 
=
∂∂ 
new
∂∂ !%
JwtSecurityTokenHandler
∂∂" 9
(
∂∂9 :
)
∂∂: ;
.
∂∂; <

WriteToken
∂∂< F
(
∂∂F G
jwtToken
∂∂G O
)
∂∂O P
;
∂∂P Q
var
∏∏ 
refreshToken
∏∏ 
=
∏∏ 
new
∏∏ "
RefreshToken
∏∏# /
{
ππ 
UserName
∫∫ 
=
∫∫ 
user
∫∫ 
.
∫∫  
CustomizedId
∫∫  ,
,
∫∫, -
TokenString
ªª 
=
ªª (
GenerateRefreshTokenString
ªª 8
(
ªª8 9
)
ªª9 :
,
ªª: ;
ExpireAt
ºº 
=
ºº 
DateTime
ºº #
.
ºº# $
Now
ºº$ '
.
ºº' (
AddHours
ºº( 0
(
ºº0 1#
JwtTokenConfiguration
ºº1 F
.
ººF G
Current
ººG N
.
ººN O$
refreshTokenExpiration
ººO e
.
ººe f
ToDoubleOrDefault
ººf w
(
ººw x
)
ººx y
)
ººy z
,
ººz {
}
ΩΩ 
;
ΩΩ 
this
ææ 
.
ææ  
usersRefreshTokens
ææ #
.
ææ# $
AddOrUpdate
ææ$ /
(
ææ/ 0
refreshToken
ææ0 <
.
ææ< =
TokenString
ææ= H
,
ææH I
refreshToken
ææJ V
,
ææV W
(
ææX Y
_
ææY Z
,
ææZ [
_
ææ\ ]
)
ææ] ^
=>
ææ_ a
refreshToken
ææb n
)
ææn o
;
ææo p
return
¿¿ 
new
¿¿ 
JwtAuthResult
¿¿ $
{
¡¡ 
AccessToken
¬¬ 
=
¬¬ 
accessToken
¬¬ )
,
¬¬) *
RefreshToken
√√ 
=
√√ 
refreshToken
√√ +
,
√√+ ,
}
ƒƒ 
;
ƒƒ 
}
≈≈ 	
private
∆∆ 
Claim
∆∆ 
[
∆∆ 
]
∆∆ 
GenerateClaims
∆∆ &
(
∆∆& '
UserInformation
∆∆' 6
	loginUser
∆∆7 @
)
∆∆@ A
{
«« 	
Claim
»» 
[
»» 
]
»» 
generatedClaims
»» #
=
»»$ %
null
»»& *
;
»»* +
var
…… 
claims
…… 
=
…… 
new
…… 
List
……  
<
……  !
Claim
……! &
>
……& '
{
   
new
ÀÀ 
Claim
ÀÀ 
(
ÀÀ 

ClaimTypes
ÀÀ $
.
ÀÀ$ %
	GivenName
ÀÀ% .
,
ÀÀ. /
	loginUser
ÀÀ0 9
.
ÀÀ9 :
CustomizedId
ÀÀ: F
)
ÀÀF G
,
ÀÀG H
new
ÃÃ 
Claim
ÃÃ 
(
ÃÃ 

ClaimTypes
ÃÃ $
.
ÃÃ$ %
NameIdentifier
ÃÃ% 3
,
ÃÃ3 4
Guid
ÃÃ5 9
.
ÃÃ9 :
NewGuid
ÃÃ: A
(
ÃÃA B
)
ÃÃB C
.
ÃÃC D
ToString
ÃÃD L
(
ÃÃL M
)
ÃÃM N
)
ÃÃN O
,
ÃÃO P
new
ÕÕ 
Claim
ÕÕ 
(
ÕÕ 

ClaimTypes
ÕÕ $
.
ÕÕ$ %
Upn
ÕÕ% (
,
ÕÕ( )
	loginUser
ÕÕ* 3
.
ÕÕ3 4
CustomizedId
ÕÕ4 @
)
ÕÕ@ A
}
ŒŒ 
;
ŒŒ 
if
—— 
(
—— 
	loginUser
—— 
.
—— 
	UserRoles
—— #
!=
——$ &
null
——' +
)
——+ ,
{
““ 
foreach
”” 
(
”” 
var
”” 
role
”” !
in
””" $
	loginUser
””% .
.
””. /
	UserRoles
””/ 8
)
””8 9
{
‘‘ 
claims
’’ 
.
’’ 
Add
’’ 
(
’’ 
new
’’ "
Claim
’’# (
(
’’( )

ClaimTypes
’’) 3
.
’’3 4
Role
’’4 8
,
’’8 9
role
’’: >
.
’’> ?
RoleName
’’? G
)
’’G H
)
’’H I
;
’’I J
}
÷÷ 
}
◊◊ 
generatedClaims
ÿÿ 
=
ÿÿ 
claims
ÿÿ $
.
ÿÿ$ %
ToArray
ÿÿ% ,
(
ÿÿ, -
)
ÿÿ- .
;
ÿÿ. /
return
ŸŸ 
generatedClaims
ŸŸ "
;
ŸŸ" #
}
⁄⁄ 	
public
€€ 
bool
€€ 
ValidateToken
€€ !
(
€€! "
string
€€" (
token
€€) .
)
€€. /
{
‹‹ 	
var
›› 
mySecret
›› 
=
›› 
Encoding
›› #
.
››# $
UTF8
››$ (
.
››( )
GetBytes
››) 1
(
››1 2#
JwtTokenConfiguration
››2 G
.
››G H
Current
››H O
.
››O P
JwtKey
››P V
)
››V W
;
››W X
var
ﬁﬁ 
mySecurityKey
ﬁﬁ 
=
ﬁﬁ 
new
ﬁﬁ  #"
SymmetricSecurityKey
ﬁﬁ$ 8
(
ﬁﬁ8 9
mySecret
ﬁﬁ9 A
)
ﬁﬁA B
;
ﬁﬁB C
var
ﬂﬂ 
tokenHandler
ﬂﬂ 
=
ﬂﬂ 
new
ﬂﬂ "%
JwtSecurityTokenHandler
ﬂﬂ# :
(
ﬂﬂ: ;
)
ﬂﬂ; <
;
ﬂﬂ< =
try
‡‡ 
{
·· 
tokenHandler
‚‚ 
.
‚‚ 
ValidateToken
‚‚ *
(
‚‚* +
token
‚‚+ 0
,
‚‚0 1
new
„„ '
TokenValidationParameters
„„ -
{
‰‰ &
ValidateIssuerSigningKey
ÂÂ ,
=
ÂÂ- .
true
ÂÂ/ 3
,
ÂÂ3 4
ValidateIssuer
ÊÊ "
=
ÊÊ# $
true
ÊÊ% )
,
ÊÊ) *
ValidateAudience
ÁÁ $
=
ÁÁ% &
true
ÁÁ' +
,
ÁÁ+ ,
ValidateLifetime
ËË $
=
ËË% &
true
ËË' +
,
ËË+ ,
ValidIssuer
ÈÈ 
=
ÈÈ  !#
JwtTokenConfiguration
ÈÈ" 7
.
ÈÈ7 8
Current
ÈÈ8 ?
.
ÈÈ? @
	JwtIssuer
ÈÈ@ I
,
ÈÈI J
ValidAudience
ÍÍ !
=
ÍÍ" ##
JwtTokenConfiguration
ÍÍ$ 9
.
ÍÍ9 :
Current
ÍÍ: A
.
ÍÍA B
Jwtaudience
ÍÍB M
,
ÍÍM N
IssuerSigningKey
ÎÎ $
=
ÎÎ% &
mySecurityKey
ÎÎ' 4
}
ÌÌ 
,
ÌÌ 
out
ÌÌ 
SecurityToken
ÌÌ  
validatedToken
ÌÌ! /
)
ÌÌ/ 0
;
ÌÌ0 1
return
ÓÓ 
true
ÓÓ 
;
ÓÓ 
}
 
catch
ÒÒ 
{
ÚÚ 
return
ÛÛ 
false
ÛÛ 
;
ÛÛ 
}
ÙÙ 
}
ıı 	
}
ˆˆ 
}˜˜ ¬
vF:\Work\Office\Projects\Nspira\Portal\HRMS_API\5-CrossCutting\Phoenix.CrossCutting.Utils\Token\JwtRefreshTokenCache.cs
	namespace 	
Phonix
 
. 
CrossCutting 
. 
Utils #
.# $
Token$ )
{ 
public		 

class		  
JwtRefreshTokenCache		 %
:		& '
IHostedService		( 6
,		6 7
IDisposable		8 C
{

 
private 
Timer 
_timer 
; 
private 
readonly 
IJwtAuthManager (
_jwtAuthManager) 8
;8 9
public  
JwtRefreshTokenCache #
(# $
IJwtAuthManager$ 3
jwtAuthManager4 B
)B C
{ 	
_jwtAuthManager 
= 
jwtAuthManager ,
;, -
} 	
public 
Task 

StartAsync 
( 
CancellationToken 0
stoppingToken1 >
)> ?
{ 	
_timer 
= 
new 
Timer 
( 
DoWork %
,% &
null' +
,+ ,
TimeSpan- 5
.5 6
Zero6 :
,: ;
TimeSpan< D
.D E
FromMinutesE P
(P Q
$numQ R
)R S
)S T
;T U
return 
Task 
. 
CompletedTask %
;% &
} 	
private 
void 
DoWork 
( 
object "
state# (
)( )
{ 	
_jwtAuthManager 
. &
RemoveExpiredRefreshTokens 6
(6 7
DateTime7 ?
.? @
Now@ C
)C D
;D E
} 	
public 
Task 
	StopAsync 
( 
CancellationToken /
stoppingToken0 =
)= >
{   	
_timer!! 
?!! 
.!! 
Change!! 
(!! 
Timeout!! "
.!!" #
Infinite!!# +
,!!+ ,
$num!!- .
)!!. /
;!!/ 0
return"" 
Task"" 
."" 
CompletedTask"" %
;""% &
}## 	
public%% 
void%% 
Dispose%% 
(%% 
)%% 
{&& 	
_timer'' 
?'' 
.'' 
Dispose'' 
('' 
)'' 
;'' 
}(( 	
})) 
}** Ω
xF:\Work\Office\Projects\Nspira\Portal\HRMS_API\5-CrossCutting\Phoenix.CrossCutting.Utils\Validation\RegularExpression.cs
	namespace 	
Phonix
 
. 
CrossCutting 
. 
Utils #
{ 
public 

static 
class 
RegularExpression )
{ 
public 
static 
readonly 
string %
Date& *
=+ ,
$str	- »
;
» …
public 
static 
readonly 
string %
Decimal& -
=. /
$str0 Y
;Y Z
public 
static 
readonly 
string %
Email& +
=, -
$str. h
;h i
public 
static 
readonly 
string %
Hex& )
=* +
$str, K
;K L
public		 
static		 
readonly		 
string		 %
Hour		& *
=		+ ,
$str		- ]
;		] ^
public

 
static

 
readonly

 
string

 %
Integer

& -
=

. /
$str

0 G
;

G H
public 
static 
readonly 
string %
Login& +
=, -
$str. C
;C D
public 
static 
readonly 
string %
Pass& *
=+ ,
$str- o
;o p
public 
static 
readonly 
string %
Url& )
=* +
$str, y
;y z
} 
} ´
pF:\Work\Office\Projects\Nspira\Portal\HRMS_API\5-CrossCutting\Phoenix.CrossCutting.Utils\Validation\Validator.cs
	namespace 	
Phonix
 
. 
CrossCutting 
. 
Utils #
{ 
public 

abstract 
class 
	Validator #
<# $
T$ %
>% &
{ 
public 
abstract 
ValidatorResult '
Validate( 0
(0 1
T1 2
obj3 6
)6 7
;7 8
public		 
void		 "
ValidateThrowException		 *
(		* +
T		+ ,
obj		- 0
)		0 1
{

 	
var 
result 
= 
this 
. 
Validate &
(& '
obj' *
)* +
;+ ,
if 
( 
! 
result 
. 
IsValid 
)  
{ 
var 
message 
= 
string $
.$ %
Join% )
() *
$str* -
,- .
result/ 5
.5 6
Errors6 <
.< =
Select= C
(C D
xD E
=>F H
xI J
.J K
ValueK P
)P Q
)Q R
;R S
} 
} 	
} 
} ƒ
vF:\Work\Office\Projects\Nspira\Portal\HRMS_API\5-CrossCutting\Phoenix.CrossCutting.Utils\Validation\ValidatorResult.cs
	namespace 	
Phonix
 
. 
CrossCutting 
. 
Utils #
{ 
public 

sealed 
class 
ValidatorResult '
{ 
public 
IDictionary 
< 
string !
,! "
string# )
>) *
Errors+ 1
{2 3
get4 7
;7 8
}9 :
=; <
new= @

DictionaryA K
<K L
stringL R
,R S
stringT Z
>Z [
([ \
)\ ]
;] ^
public		 
bool		 
IsValid		 
=>		 
this		 #
.		# $
Errors		$ *
==		+ -
null		. 2
||		3 5
this		6 :
.		: ;
Errors		; A
.		A B
Count		B G
==		H J
$num		K L
;		L M
}

 
} 